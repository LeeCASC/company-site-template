<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wintex Logistics Corporation - 物流人才招聘</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --primary:#1a4b75; --secondary:#2c5b8a; --accent:#4dabf7; --accent2:#2ecc71; --light:#f8f9fa; --dark:#0d2b46;
      --text:#333; --text-light:#666;
    }
    body { font-family:'Noto Sans SC','Roboto',sans-serif; background:linear-gradient(135deg,#f0f7ff 0%,#e6f7ff 100%); color:var(--text); line-height:1.6; position:relative; min-height:100vh; }
    .container { max-width:1200px; margin:0 auto; padding:20px; padding-bottom:150px; }

    /* 语言切换按钮 */
    .language-switcher { position:absolute; top:20px; right:20px; z-index:100; display:flex; gap:10px; }
    .lang-btn { background:rgba(255,255,255,0.9); border:2px solid var(--primary); color:var(--primary); padding:8px 15px; border-radius:30px; cursor:pointer; font-weight:600; transition:all .3s ease; box-shadow:0 3px 10px rgba(0,0,0,.1); }
    .lang-btn:hover { background:var(--primary); color:#fff; }
    .admin-btn { background:linear-gradient(90deg,#ff6b6b 0%,#ee5a52 100%); border-color:#ff6b6b; color:#fff; }
    .admin-btn:hover { background:#ff5252; border-color:#ff5252; transform:translateY(-2px); box-shadow:0 5px 15px rgba(255,107,107,.4); }

    header { background:linear-gradient(rgba(26,75,117,0.7),rgba(44,91,138,0.7)), url('/highresolution/WechatIMG155.jpg'); background-size:cover; background-position:center; color:#fff; padding:50px 20px 30px; border-radius:12px; box-shadow:0 8px 25px rgba(0,0,0,.15); margin-bottom:30px; text-align:center; position:relative; overflow:hidden; max-width:1200px; margin-left:auto; margin-right:auto; }
    header::before { content:""; position:absolute; inset:0; background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.08)"/></svg>'); background-size:cover; }
    .header-content { position:relative; z-index:2; }
    h1 { font-size:2.8rem; margin-bottom:10px; color:#fff; text-shadow:0 2px 4px rgba(0,0,0,.3); }
    .tagline { font-size:1.4rem; color:#a8d1ff; margin-bottom:25px; font-weight:300; }

    .job-tabs { display:flex; justify-content:center; margin:30px 0; gap:15px; flex-wrap:wrap; }
    .tab-btn { background:rgba(255,255,255,.15); border:none; color:#fff; padding:15px 35px; font-size:1.1rem; border-radius:50px; cursor:pointer; transition:all .3s ease; font-weight:600; backdrop-filter:blur(5px); border:1px solid rgba(255,255,255,.2); min-width:180px; text-align:center; }
    .tab-btn.active { background:var(--accent2); box-shadow:0 4px 15px rgba(46,204,113,.4); }
    .tab-btn:hover:not(.active) { background:rgba(255,255,255,.25); }

    .job-content { display:none; animation:fadeIn .5s ease; }
    .job-content.active { display:block; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(20px);} to { opacity:1; transform:translateY(0);} }

    .job-highlights { display:flex; justify-content:center; gap:30px; margin-top:20px; flex-wrap:wrap; }
    .highlight { background:rgba(255,255,255,.85); border-radius:12px; padding:20px; text-align:center; min-width:200px; box-shadow:0 5px 15px rgba(0,0,0,.08); transition:all .3s ease; }
    .highlight:hover { transform:translateY(-5px); box-shadow:0 8px 20px rgba(0,0,0,.12); }
    .highlight i { font-size:2.5rem; margin-bottom:15px; color:var(--accent); }
    .highlight h3 { font-size:1.3rem; margin-bottom:8px; color:var(--primary); }
    .highlight p { font-size:1.1rem; color:var(--text-light); }

    .salary-highlight { background:linear-gradient(135deg,#ffd166 0%,#ff9e00 100%); color:#fff; padding:12px 25px; border-radius:30px; display:inline-flex; align-items:center; gap:10px; font-weight:700; margin:15px 0; box-shadow:0 4px 10px rgba(255,158,0,.3); }

    .btn-contact { display:inline-block; background:linear-gradient(90deg,var(--accent2) 0%,#27ae60 100%); color:#fff; padding:15px 35px; font-size:1.1rem; border-radius:50px; text-decoration:none; margin:25px 0; box-shadow:0 4px 15px rgba(39,174,96,.4); transition:all .3s ease; border:none; cursor:pointer; font-weight:600; }
    .btn-contact:hover { transform:translateY(-3px); box-shadow:0 7px 20px rgba(39,174,96,.6); }
    
    /* 编辑模式样式 */
    .edit-controls {
        display: none;
        background: rgba(255, 255, 255, 0.95);
        border: 2px dashed #ff6b6b;
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
        backdrop-filter: blur(10px);
    }
    
    .edit-controls.active {
        display: block;
    }
    
    .edit-controls h3 {
        color: var(--primary);
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .job-edit-section {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        border: 1px solid #e9ecef;
    }
    
    .job-edit-section h4 {
        color: var(--primary);
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .form-group {
        margin-bottom: 15px;
    }
    
    .form-group label {
        display: block;
        font-weight: 600;
        color: var(--primary);
        margin-bottom: 5px;
    }
    
    .form-group input, .form-group textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 14px;
        font-family: inherit;
    }
    
    .form-group textarea {
        min-height: 80px;
        resize: vertical;
    }
    
    .form-actions {
        display: flex;
        gap: 15px;
        justify-content: flex-end;
        margin-top: 25px;
    }
    
    .btn {
        padding: 12px 25px;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .btn-primary {
        background: linear-gradient(90deg, var(--primary), var(--secondary));
        color: white;
    }
    
    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(26, 75, 117, 0.4);
    }
    
    .btn-secondary {
        background: #6c757d;
        color: white;
    }
    
    .btn-secondary:hover {
        background: #5a6268;
        transform: translateY(-2px);
    }
    .btn-contact i { margin-right:10px; }

    .job-details { display:flex; gap:30px; margin-bottom:40px; flex-wrap:wrap; }
    .card { background:#fff; border-radius:15px; box-shadow:0 8px 30px rgba(0,0,0,.1); padding:30px; flex:1; min-width:300px; transition:transform .3s ease; position:relative; }
    .card:hover { transform:translateY(-5px); box-shadow:0 12px 35px rgba(0,0,0,.15); }
    .card h2 { color:var(--primary); border-bottom:3px solid var(--accent); padding-bottom:15px; margin-bottom:20px; font-size:1.5rem; display:flex; align-items:center; white-space:nowrap; overflow:visible; }
    .card h2 span { font-size:1.4rem; white-space:nowrap; overflow:visible; flex-shrink:0; }
    .card h2 i { margin-right:12px; color:var(--accent2); flex-shrink:0; }
    .card ul { list-style-type:none; padding-left:5px; }
    .card li { margin-bottom:15px; padding-left:30px; position:relative; font-size:1.1rem; color:var(--text); }
    .card li:before { content:"•"; color:var(--accent); font-size:1.8rem; position:absolute; left:0; top:-5px; }
    .sub-list { margin-top:8px; padding-left:20px; }
    .sub-list li { font-size:1rem; color:var(--text-light); padding-left:20px; }
    .sub-list li:before { content:"›"; color:var(--accent2); top:-2px; }

    .why-join { background:linear-gradient(135deg,var(--secondary) 0%,var(--primary) 100%); border-radius:15px; padding:30px; margin:40px 0; box-shadow:0 8px 30px rgba(0,0,0,.2); color:#fff; }
    .why-join h2 { text-align:center; font-size:2.2rem; margin-bottom:30px; color:#fff; }
    .benefits { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:25px; }
    .benefit-card { background:rgba(255,255,255,.12); border-radius:12px; padding:25px; text-align:center; backdrop-filter:blur(5px); border:1px solid rgba(255,255,255,.15); transition:all .3s ease; }
    .benefit-card:hover { transform:scale(1.03); }
    .benefit-card i { font-size:3rem; color:var(--accent); margin-bottom:20px; }
    .benefit-card h3 { font-size:1.5rem; margin-bottom:15px; color:var(--accent2); }
    .benefit-card p { font-size:1.1rem; color:#e0f0ff; }

    .work-environment { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; margin:40px 0; }
    .env-card { background:#fff; border-radius:12px; overflow:hidden; box-shadow:0 8px 20px rgba(0,0,0,.1); }
    .env-img { height:200px; background-size:cover; background-position:center; }
    .env-content { padding:20px; }
    .env-content h3 { color:var(--primary); margin-bottom:10px; }

    footer { text-align:center; padding:15px 20px; color:var(--text-light); font-size:0.9rem; position:absolute; bottom:0; left:50%; transform:translateX(-50%); width:100%; max-width:1200px; background:transparent; border-top:none; }
    .footer-logo { font-size:1.8rem; font-weight:700; color:var(--primary); margin-bottom:8px; letter-spacing:1px; }
    .contact-info { display:flex; justify-content:center; gap:20px; margin:10px 0; flex-wrap:wrap; }
    .contact-item { display:flex; align-items:center; gap:8px; font-size:0.45rem; }
    .contact-item i { color:var(--accent); font-size:1rem; }
    .bilingual { display:flex; gap:10px; margin-bottom:10px; }
    .bilingual p { flex:1; padding:10px; background:rgba(255,255,255,.7); border-radius:8px; }
    .bilingual p:first-child { border-right:2px solid var(--accent); }

    @media (max-width:768px) {
      .job-details { flex-direction:column; }
      .job-highlights { flex-direction:row; justify-content:center; gap:6px; margin-top:15px; }
      .highlight { padding:8px 6px; min-width:auto; flex:1; max-width:120px; }
      .highlight i { font-size:1.2rem; margin-bottom:5px; }
      .highlight h3 { font-size:0.7rem; margin-bottom:3px; }
      .highlight p { font-size:0.65rem; }
      .bilingual { flex-direction:column; }
      .bilingual p:first-child { border-right:none; border-bottom:2px solid var(--accent); }
      h1 { font-size:2.2rem; }
      .tagline { font-size:0.75rem; white-space:nowrap; letter-spacing:-0.2px; line-height:1.2; }
      .tab-btn { padding:12px 20px; font-size:1rem; min-width:140px; }
      .contact-info { flex-direction:column; gap:15px; }
      .card h2 { font-size:1.2rem; }
      .card h2 span { font-size:1.1rem; }
      .language-switcher { position:relative; top:0; right:0; text-align:center; margin:15px 0; }
      .footer-logo { font-size:1rem; margin-bottom:5px; letter-spacing:0.5px; }
      footer { padding:10px 15px; font-size:0.8rem; }
      .container { padding-bottom:180px; }
      .btn-contact { margin-bottom:20px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- 语言切换 -->
    <div class="language-switcher">
      <button class="lang-btn" id="langCN">中文</button>
      <button class="lang-btn" id="langEN">English</button>
      <button class="lang-btn admin-btn" id="editBtn" onclick="openAdminPage()">
        <i class="fas fa-edit"></i> <span id="edit-text">编辑</span>
      </button>
    </div>

    <header>
      <div class="header-content">
        <h1 id="main-title">物流人才招聘</h1>
        <p class="tagline" id="sub-title">加入Wintex，共同打造菲律宾清洁能源未来</p>

        <div class="job-tabs" id="job-tabs-container">
          <!-- 动态生成的tab按钮将插入这里 -->
        </div>

        <div class="job-highlights">
          <div class="highlight">
            <i class="fas fa-map-marker-alt"></i>
            <h3 id="location-title">工作地点</h3>
            <p id="location-desc">菲律宾项目现场</p>
          </div>
          <div class="highlight">
            <i class="fas fa-handshake"></i>
            <h3 id="contract-title">合同类型</h3>
            <p id="contract-desc">长期项目制</p>
          </div>
          <div class="highlight">
            <i class="fas fa-calendar-alt"></i>
            <h3 id="status-title">招聘状态</h3>
            <p id="status-desc">火热进行中</p>
          </div>
        </div>
      </div>
    </header>

    <!-- 职位内容容器 -->
    <div id="job-contents-container">
      <!-- 动态生成的职位内容将插入这里 -->
    </div>
    
    <!-- 保留原有的静态内容作为后备（向后兼容） -->
    <div class="job-content active" id="business-content" style="display:none;">
      <div class="job-details">
        <div class="card">
          <h2><i class="fas fa-tasks"></i> <span id="business-responsibility-title">核心职责</span></h2>
          <ul id="business-responsibilities">
            <li>起草/监管7类分包合同：船务代理、码头操作、拖轮公司、吊装租赁、道路改造、电力迁改、林木修剪</li>
            <li>审核分包商账单，管控付款进度（单项目常涉及5+分包商协同）</li>
            <li>依据工程合同条款处理进度款申请、变更签证、履约保函延期</li>
            <li>主导项目索赔：因总包商原因导致的运输延误及物流成本增加的索赔</li>
            <li>监控特有成本项：桥梁加固费、临时征地费、警车开道费、超限许可证</li>
            <li>编制风电项目分标段损益报告（海运/港口/陆运）</li>
          </ul>
        </div>
        <div class="card">
          <h2><i class="fas fa-user-graduate"></i> <span id="business-requirements-title">职位要求</span></h2>
          <ul id="business-requirements">
            <li>5年以上工程物流/建筑施工企业经验（需参与过大型设备运输项目）</li>
            <li>3年以上多类型分包商管理经验（同时管理≥3类）</li>
            <li>≥5次成功向总包商索赔经验（需面试展示证明文件）</li>
            <li>精通重型运输合同条款设计：滞期费阶梯计价、吊装事故责任界定</li>
            <li>熟悉菲律宾大件运输法规：DPWH超限许可流程、LGU地方道路使用许可、NGCP线路迁改规范</li>
            <li>总包商索赔专长：证据链构建、成本计算模型</li>
            <li>菲律宾籍，能适应项目现场工作环境</li>
            <li>持有有效驾照，能前往不同项目现场</li>
            <li>流利的英语沟通能力</li>
          </ul>
        </div>
        <div class="card">
          <h2><i class="fas fa-star"></i> <span id="business-preferred-title">优先条件</span></h2>
          <ul id="business-preferredConditions">
            <li>有大型工程物流项目经验者优先</li>
          </ul>
          <div class="salary-highlight"><i class="fas fa-money-bill-wave"></i> <span id="business-salary">薪资待遇：面议</span></div>
        </div>
      </div>
    </div>

    <!-- 现场翻译职位内容 -->
    <div class="job-content" id="translator-content">
      <div class="job-details">
        <div class="card">
          <h2><i class="fas fa-tasks"></i> <span id="translator-responsibility-title">核心职责</span></h2>
          <ul id="translator-responsibilities">
            <li>为中方特种设备操作手提供现场英语口语翻译服务</li>
            <li>协助操作手与当地工作人员进行日常沟通协调</li>
            <li>翻译设备操作手册、安全规范等技术文档</li>
            <li>参与项目会议并提供中英双向翻译支持</li>
            <li>协助处理中方员工与当地社区的基本沟通</li>
            <li>记录并整理翻译日志，确保信息准确传递</li>
          </ul>
        </div>
        <div class="card">
          <h2><i class="fas fa-user-graduate"></i> <span id="translator-requirements-title">职位要求</span></h2>
          <ul id="translator-requirements">
            <li>中国籍应届本科毕业生</li>
            <li>英语相关专业优先（如翻译、英语、国际商务等）</li>
            <li>大学英语六级600分以上或专四/专八良好以上</li>
            <li>优秀的中英双语口语表达能力</li>
            <li>快速学习技术术语和专业知识的能力</li>
            <li>良好的跨文化沟通和理解能力</li>
            <li>吃苦耐劳，能适应项目现场环境</li>
            <li>有耐心，脾气好，能妥善处理压力</li>
            <li>积极主动，有上进心，学习能力强</li>
            <li>具备优秀的情绪管理能力</li>
            <li>良好的团队协作精神</li>
          </ul>
        </div>
        <div class="card">
          <h2><i class="fas fa-star"></i> <span id="translator-preferred-title">优先条件</span></h2>
          <ul id="translator-preferredConditions">
            <li>有机械、工程类知识背景</li>
            <li>通过CATTI口译三级或以上</li>
            <li>有海外学习或生活经历</li>
            <li>掌握基础菲律宾语</li>
          </ul>
          <div class="salary-highlight"><i class="fas fa-money-bill-wave"></i> <span id="translator-salary">薪资待遇：面议</span></div>
        </div>
      </div>
    </div>

    <!-- 货代操作职位内容 -->
    <div class="job-content" id="freight-content">
      <div class="job-details">
        <div class="card">
          <h2><i class="fas fa-tasks"></i> <span id="freight-responsibility-title">核心职责</span></h2>
          <ul id="freight-responsibilities">
            <li>负责国际货运的全流程操作，包括订舱、报关、单证制作及跟踪</li>
            <li>协调船公司、港口、仓库等各方资源，确保货物按时安全运输</li>
            <li>处理进出口货物的报关报检及相关文件准备工作</li>
            <li>监控货物运输状态，及时处理运输过程中的异常情况</li>
            <li>与客户保持良好沟通，及时反馈货物运输信息</li>
            <li>优化货运方案，降低物流成本，提高运输效率</li>
            <li>准备和处理提单、发票、装箱单等运输单据</li>
            <li>确保所有单证符合国际贸易规则和目的国海关要求</li>
            <li>审核信用证条款，确保单证一致</li>
            <li>处理进出口报关文件及相关许可证</li>
          </ul>
        </div>
        <div class="card">
          <h2><i class="fas fa-user-graduate"></i> <span id="freight-requirements-title">职位要求</span></h2>
          <ul id="freight-requirements">
            <li>至少3年以上国际货代公司工作经验</li>
            <li>熟悉海运、空运及多式联运操作流程</li>
            <li>有大型设备或风电项目物流经验者优先</li>
            <li>精通国际贸易术语（Incoterms 2020）</li>
            <li>熟悉国际海运、空运操作流程及相关法规</li>
            <li>了解菲律宾海关进出口政策及清关流程</li>
            <li>掌握主要船公司及航空公司的操作规范</li>
            <li>熟练使用物流管理系统（如CargoWise, SAP等）</li>
            <li>精通Office办公软件，特别是Excel高级功能</li>
            <li>出色的多任务处理能力及时间管理能力</li>
            <li>优秀的英语读写能力（CET-6或同等以上）</li>
            <li>具备高度责任心和抗压能力</li>
            <li>良好的沟通协调能力和团队合作精神</li>
            <li>能适应快节奏工作环境，处理紧急情况</li>
          </ul>
        </div>
        <div class="card">
          <h2><i class="fas fa-star"></i> <span id="freight-preferred-title">优先条件</span></h2>
          <ul id="freight-preferredConditions">
            <li>有大型设备或风电项目物流经验者优先</li>
          </ul>
          <div class="salary-highlight"><i class="fas fa-money-bill-wave"></i> <span id="freight-salary">薪资待遇：面议</span></div>
        </div>
      </div>
    </div>

    <div style="text-align:center; margin:40px 0;">
      <button class="btn-contact" id="contactBtn"><i class="fas fa-paper-plane"></i> <span id="apply-text">立即提交简历</span></button>
    </div>

    <footer>
      <div class="footer-logo">Wintex Logistics Corporation</div>
      <p id="footer-desc">致力于全球可再生能源基础设施建设和物流服务</p>
      <div class="contact-info">
        <div class="contact-item"><i class="fas fa-phone"></i><span>招聘热线: 00639510941210</span></div>
        <div class="contact-item"><i class="fas fa-envelope"></i><span>邮箱: wintexlogistics@wintex.com.ph</span></div>
        <div class="contact-item"><i class="fas fa-map-marker-alt"></i><span id="location-text">菲律宾马尼拉总部</span></div>
      </div>
      <p>© 2023 Wintex Logistics Corporation <span id="rights-text">版权所有</span></p>
    </footer>
  </div>

  <!-- 可选：如果你有独立的增强脚本，可保留这一行 -->
  <!-- <script src="careers-dynamic.js"></script> -->

  <script>
    // ===== 语言字典（你的原始 translations 拷贝） =====
    const translations = {
      cn: { /* —— 为简洁，这里省略注释，仅保留键值 —— */
        "main-title":"物流人才招聘","sub-title":"加入Wintex，共同打造菲律宾清洁能源未来","business-tab":"商务助理","translator-tab":"现场翻译","freight-tab":"货代操作","location-title":"工作地点","location-desc":"菲律宾项目现场","contract-title":"合同类型","contract-desc":"长期项目制","status-title":"招聘状态","status-desc":"火热进行中","apply-text":"立即提交简历","rights-text":"版权所有","business-salary":"薪资待遇：面议","translator-salary":"薪资待遇：面议","freight-salary":"薪资待遇：面议",
        "responsibility-title":"核心职责","business-responsibility-title":"核心职责","translator-responsibility-title":"核心职责","freight-responsibility-title":"核心职责","subcontractor-title":"工程分包商管理","subcontractor-desc":"起草/监管7类分包合同：船务代理、码头操作、拖轮公司、吊装租赁、道路改造、电力迁改、林木修剪","payment-desc":"审核分包商账单，管控付款进度（单项目常涉及5+分包商协同）","epc-title":"总包商(EPC)商务对接","contract-process":"依据工程合同条款处理进度款申请、变更签证、履约保函延期","claim-desc":"主导项目索赔：因总包商原因导致的运输延误及物流成本增加的索赔","cost-title":"重型运输成本控制","cost-monitor":"监控特有成本项：桥梁加固费、临时征地费、警车开道费、超限许可证","report-desc":"编制风电项目分标段损益报告（海运/港口/陆运）","requirements-title":"职位要求","business-requirements-title":"职位要求","translator-requirements-title":"职位要求","freight-requirements-title":"职位要求","experience-title":"经验要求","exp1":"5年以上工程物流/建筑施工企业经验（需参与过大型设备运输项目）","exp2":"3年以上多类型分包商管理经验（同时管理≥3类）","exp3":"≥5次成功向总包商索赔经验（需面试展示证明文件）","competencies-title":"核心能力","skill1":"精通重型运输合同条款设计：滞期费阶梯计价、吊装事故责任界定","skill2":"熟悉菲律宾大件运输法规：DPWH超限许可流程、LGU地方道路使用许可、NGCP线路迁改规范","skill3":"总包商索赔专长：证据链构建、成本计算模型","other-title":"其他要求","req1":"菲律宾籍，能适应项目现场工作环境","req2":"持有有效驾照，能前往不同项目现场","req3":"流利的英语沟通能力",
        "duties-title":"工作职责","duty1":"为中方特种设备操作手提供现场英语口语翻译服务","duty2":"协助操作手与当地工作人员进行日常沟通协调","duty3":"翻译设备操作手册、安全规范等技术文档","duty4":"参与项目会议并提供中英双向翻译支持","duty5":"协助处理中方员工与当地社区的基本沟通","duty6":"记录并整理翻译日志，确保信息准确传递","environment-title":"工作环境","env1":"菲律宾风电项目现场（马尼拉及周边地区）","env2":"跟随设备操作团队进行户外作业","env3":"需要适应热带气候和项目现场条件","env4":"提供项目现场住宿及餐饮","position-requirements":"职位要求","basic-title":"基本要求","basic1":"中国籍应届本科毕业生","basic2":"英语相关专业优先（如翻译、英语、国际商务等）","basic3":"大学英语六级600分以上或专四/专八良好以上","core-title":"核心能力","core1":"优秀的中英双语口语表达能力","core2":"快速学习技术术语和专业知识的能力","core3":"良好的跨文化沟通和理解能力","personal-title":"个人素质","personal1":"吃苦耐劳，能适应项目现场环境","personal2":"有耐心，脾气好，能妥善处理压力","personal3":"积极主动，有上进心，学习能力强","personal4":"具备优秀的情绪管理能力","personal5":"良好的团队协作精神","preferred-title":"优先条件","business-preferred-title":"优先条件","translator-preferred-title":"优先条件","freight-preferred-title":"优先条件","pref1":"有机械、工程类知识背景","pref2":"通过CATTI口译三级或以上","pref3":"有海外学习或生活经历","pref4":"掌握基础菲律宾语",
        "freight-duties-title":"工作职责","freight-duty1":"负责国际货运的全流程操作，包括订舱、报关、单证制作及跟踪","freight-duty2":"协调船公司、港口、仓库等各方资源，确保货物按时安全运输","freight-duty3":"处理进出口货物的报关报检及相关文件准备工作","freight-duty4":"监控货物运输状态，及时处理运输过程中的异常情况","freight-duty5":"与客户保持良好沟通，及时反馈货物运输信息","freight-duty6":"优化货运方案，降低物流成本，提高运输效率","documents-title":"单证处理","doc1":"准备和处理提单、发票、装箱单等运输单据","doc2":"确保所有单证符合国际贸易规则和目的国海关要求","doc3":"审核信用证条款，确保单证一致","doc4":"处理进出口报关文件及相关许可证","freight-requirements":"职位要求","experience-req-title":"经验要求","freight-exp1":"至少3年以上国际货代公司工作经验","freight-exp2":"熟悉海运、空运及多式联运操作流程","freight-exp3":"有大型设备或风电项目物流经验者优先","knowledge-title":"专业知识","knowledge1":"精通国际贸易术语（Incoterms 2020）","knowledge2":"熟悉国际海运、空运操作流程及相关法规","knowledge3":"了解菲律宾海关进出口政策及清关流程","knowledge4":"掌握主要船公司及航空公司的操作规范","skills-title":"技能要求","skill-req1":"熟练使用物流管理系统（如CargoWise, SAP等）","skill-req2":"精通Office办公软件，特别是Excel高级功能","skill-req3":"出色的多任务处理能力及时间管理能力","skill-req4":"优秀的英语读写能力（CET-6或同等以上）","additional-title":"其他要求","add-req1":"具备高度责任心和抗压能力","add-req2":"良好的沟通协调能力和团队合作精神","add-req3":"能适应快节奏工作环境，处理紧急情况",
        "env-title1":"现代化物流中心","env-desc1":"使用先进物流管理系统，优化全球供应链运作","env-title2":"全球物流网络","env-desc2":"连接全球港口、机场和陆运枢纽的高效物流网络","env-title3":"专业发展平台","env-desc3":"提供专业培训和职业发展通道，培养物流专家",
        "why-title":"为什么加入Wintex？","benefit-title1":"国际视野","benefit-desc1":"参与\"一带一路\"重点项目，拓展国际职业发展空间","benefit-title2":"行业前沿","benefit-desc2":"投身快速发展的可再生能源行业，掌握前沿技术","benefit-title3":"职业发展","benefit-desc3":"清晰的晋升通道和专业培训体系，助力职业成长",
        "footer-desc":"致力于全球可再生能源基础设施建设和物流服务","location-text":"菲律宾马尼拉总部"
      },
      en: {
        "main-title":"Logistics Talent Recruitment","sub-title":"Join Wintex, Build the Future of Clean Energy in the Philippines","business-tab":"Business Assistant","translator-tab":"On-site Translator","freight-tab":"Freight Forwarding Operator","location-title":"Location","location-desc":"Project Sites in Philippines","contract-title":"Contract Type","contract-desc":"Long-term Project Based","status-title":"Status","status-desc":"Now Hiring","apply-text":"Submit Your Resume","rights-text":"All Rights Reserved","business-salary":"Salary: Negotiable","translator-salary":"Salary: Negotiable","freight-salary":"Salary: Negotiable",
        "responsibility-title":"Core Responsibilities","business-responsibility-title":"Core Responsibilities","translator-responsibility-title":"Core Responsibilities","freight-responsibility-title":"Core Responsibilities","subcontractor-title":"Subcontractor Management","subcontractor-desc":"Draft/supervise contracts for 7 types of subcontractors: shipping agency, terminal operations, tugboat services, crane rental, road modification, power line relocation, tree trimming","payment-desc":"Verify subcontractor invoices and control payment schedules (managing 5+ subcontractors per project)","epc-title":"EPC Contractor Engagement","contract-process":"Process progress payment claims, change orders, performance bond extensions under engineering contracts","claim-desc":"Lead project claims against EPC contractors for delays and cost overruns caused by EPC decisions","cost-title":"Heavy Transport Cost Control","cost-monitor":"Monitor specialized costs: bridge reinforcement, temporary land acquisition, police escort fees, oversize permits","report-desc":"Prepare segmented P&L reports for wind projects (sea/port/land transport)","requirements-title":"Requirements","business-requirements-title":"Requirements","translator-requirements-title":"Requirements","freight-requirements-title":"Requirements","experience-title":"Experience","exp1":"5+ years in engineering logistics/construction (experience with heavy equipment transport projects required)","exp2":"3+ years managing multiple subcontractor types (concurrently managing ≥3 types)","exp3":"≥5 successful claims against EPC contractors (proof required during interview)","competencies-title":"Core Competencies","skill1":"Expertise in heavy transport contract clauses: demurrage tiered pricing, crane accident liability allocation","skill2":"Knowledge of Philippine heavy transport regulations: DPWH oversize permits, LGU road access approvals, NGCP relocation standards","skill3":"EPC claim specialization: evidence chain development, cost modeling","other-title":"Other Requirements","req1":"Filipino national, able to work at project sites","req2":"Valid driver's license, able to travel to different sites","req3":"Fluent English communication skills",
        "duties-title":"Job Duties","duty1":"Provide on-site English interpretation for Chinese heavy equipment operators","duty2":"Assist operators in daily communication with local staff","duty3":"Translate technical documents such as equipment manuals and safety regulations","duty4":"Provide bilingual support in project meetings","duty5":"Assist in basic communication between Chinese staff and local communities","duty6":"Maintain interpretation logs to ensure accurate information transfer","environment-title":"Work Environment","env1":"Wind power project sites in Philippines (Manila and surrounding areas)","env2":"Field work with equipment operation teams","env3":"Need to adapt to tropical climate and site conditions","env4":"On-site accommodation and meals provided","position-requirements":"Position Requirements","basic-title":"Basic Requirements","basic1":"Chinese fresh graduate with bachelor's degree","basic2":"English-related majors preferred (translation, English, international business, etc.)","basic3":"CET-6 score ≥600 or TEM-4/8 with good grade","core-title":"Core Competencies","core1":"Excellent Chinese-English oral interpretation skills","core2":"Ability to quickly learn technical terminology and professional knowledge","core3":"Strong cross-cultural communication and understanding skills","personal-title":"Personal Qualities","personal1":"Hardworking, adaptable to project site conditions","personal2":"Patient, good-tempered, able to handle pressure","personal3":"Proactive, motivated, fast learner","personal4":"Excellent emotional management skills","personal5":"Strong team collaboration spirit","preferred-title":"Preference","business-preferred-title":"Preference","translator-preferred-title":"Preference","freight-preferred-title":"Preference","pref1":"Background in mechanical/engineering knowledge","pref2":"CATTI Level 3 Interpretation or higher","pref3":"Overseas study or living experience","pref4":"Basic Filipino language skills",
        "freight-duties-title":"Job Duties","freight-duty1":"Manage end-to-end international freight operations including booking, customs clearance, documentation and tracking","freight-duty2":"Coordinate with shipping lines, ports, warehouses to ensure timely and safe cargo transportation","freight-duty3":"Handle customs declaration and inspection for import/export goods","freight-duty4":"Monitor cargo status and resolve any transportation issues promptly","freight-duty5":"Maintain good communication with clients and provide shipment updates","freight-duty6":"Optimize shipping solutions to reduce costs and improve efficiency","documents-title":"Documentation","doc1":"Prepare and process shipping documents including BL, invoices, packing lists","doc2":"Ensure all documents comply with international trade rules and destination customs requirements","doc3":"Review L/C terms to ensure document consistency","doc4":"Handle import/export customs documents and related permits","freight-requirements":"Requirements","experience-req-title":"Experience","freight-exp1":"Minimum 3 years experience in international freight forwarding","freight-exp2":"Familiar with sea, air and multimodal transportation processes","freight-exp3":"Experience in heavy equipment or wind power logistics preferred","knowledge-title":"Professional Knowledge","knowledge1":"Proficient in Incoterms 2020","knowledge2":"Knowledge of international sea/air transport regulations","knowledge3":"Understanding of Philippines customs policies and clearance procedures","knowledge4":"Familiar with major shipping lines and airlines operations","skills-title":"Skills","skill-req1":"Proficient in logistics management systems (e.g. CargoWise, SAP)","skill-req2":"Advanced MS Office skills, especially Excel","skill-req3":"Excellent multitasking and time management abilities","skill-req4":"Strong English reading/writing skills (CET-6 or equivalent)","additional-title":"Additional Requirements","add-req1":"High sense of responsibility and stress tolerance","add-req2":"Good communication and teamwork skills","add-req3":"Ability to work in fast-paced environment and handle emergencies",
        "env-title1":"Modern Logistics Center","env-desc1":"Utilizing advanced logistics management systems to optimize global supply chain","env-title2":"Global Logistics Network","env-desc2":"Efficient network connecting ports, airports and land hubs worldwide","env-title3":"Professional Development","env-desc3":"Training programs and career development paths for logistics specialists",
        "why-title":"Why Join Wintex?","benefit-title1":"Global Perspective","benefit-desc1":"Participate in Belt and Road key projects, expand international career","benefit-title2":"Industry Frontier","benefit-desc2":"Join fast-growing renewable energy industry, master cutting-edge technologies","benefit-title3":"Career Development","benefit-desc3":"Clear promotion path and professional training system",
        "footer-desc":"Dedicated to global renewable energy infrastructure and logistics services","location-text":"Headquarters in Manila, Philippines"
      }
    };

    (function(){
      // 优先检查 URL 参数，如果存在则使用 URL 参数，否则使用 localStorage，最后才使用默认检测
      const urlParams = new URLSearchParams(window.location.search);
      const urlLang = urlParams.get('lang');
      let currentLang;
      if (urlLang) {
        // URL 参数存在，优先使用 URL 参数
        if (urlLang === 'en') {
          currentLang = 'en';
        } else if (urlLang === 'zh') {
          currentLang = 'cn'; // 将 Next.js 的 'zh' 映射为 'cn'
        } else if (urlLang === 'cn') {
          currentLang = 'cn';
        } else {
          currentLang = detectInitialLanguage();
        }
        // 将检测到的语言保存到 localStorage
        localStorage.setItem('lang', currentLang);
        console.log('Language set from URL parameter:', urlLang, '->', currentLang);
      } else {
        // URL 参数不存在，使用 localStorage 或默认检测
        const storedLang = localStorage.getItem('lang');
        if (storedLang) {
          currentLang = storedLang;
          console.log('Language set from localStorage:', currentLang);
        } else {
          currentLang = detectInitialLanguage();
          console.log('Language set from detection:', currentLang);
        }
      }
      let isEditMode = false;
      let originalData = null;
      
      // 默认招聘数据
      const defaultJobsData = {
        jobs: [
          {
            id: 'business',
            title: { cn: '商务助理', en: 'Business Assistant' },
            description: { cn: '负责工程分包商管理、总包商商务对接、重型运输成本控制等工作', en: 'Responsible for subcontractor management, EPC contractor engagement, and heavy transport cost control' },
            requirements: { cn: ['5年以上工程物流/建筑施工企业经验', '3年以上多类型分包商管理经验', '≥5次成功向总包商索赔经验', '菲律宾籍，能适应项目现场工作环境', '流利的英语沟通能力'], en: ['5+ years in engineering logistics/construction', '3+ years managing multiple subcontractor types', '≥5 successful claims against EPC contractors', 'Filipino national, able to work at project sites', 'Fluent English communication skills'] },
            salary: { cn: '薪资待遇：面议', en: 'Salary: Negotiable' }
          },
          {
            id: 'translator',
            title: { cn: '现场翻译', en: 'On-site Translator' },
            description: { cn: '为中方特种设备操作手提供现场英语口语翻译服务', en: 'Provide on-site English interpretation for Chinese heavy equipment operators' },
            requirements: { cn: ['中国籍应届本科毕业生', '英语相关专业优先', '大学英语六级600分以上', '优秀的中英双语口语表达能力', '吃苦耐劳，能适应项目现场环境'], en: ['Chinese fresh graduate with bachelor\'s degree', 'English-related majors preferred', 'CET-6 score ≥600', 'Excellent Chinese-English oral interpretation skills', 'Hardworking, adaptable to project site conditions'] },
            salary: { cn: '薪资待遇：面议', en: 'Salary: Negotiable' }
          },
          {
            id: 'freight',
            title: { cn: '货代操作', en: 'Freight Forwarding Operator' },
            description: { cn: '负责国际货运的全流程操作，包括订舱、报关、单证制作及跟踪', en: 'Manage end-to-end international freight operations including booking, customs clearance, documentation and tracking' },
            requirements: { cn: ['至少3年以上国际货代公司工作经验', '熟悉海运、空运及多式联运操作流程', '精通国际贸易术语（Incoterms 2020）', '熟练使用物流管理系统', '优秀的英语读写能力'], en: ['Minimum 3 years experience in international freight forwarding', 'Familiar with sea, air and multimodal transportation processes', 'Proficient in Incoterms 2020', 'Proficient in logistics management systems', 'Strong English reading/writing skills'] },
            salary: { cn: '薪资待遇：面议', en: 'Salary: Negotiable' }
          }
        ]
      };
      
      // 从本地存储加载数据
      function loadJobsData() {
        const saved = localStorage.getItem('careersData');
        if (saved) {
          try {
            return JSON.parse(saved);
          } catch (e) {
            console.error('Error parsing saved data:', e);
          }
        }
        return defaultJobsData;
      }
      
      // 保存数据到本地存储
      function saveJobsData(data) {
        localStorage.setItem('careersData', JSON.stringify(data));
      }
      
      // 获取当前数据
      let jobsData = loadJobsData();
      originalData = JSON.parse(JSON.stringify(jobsData));
      let careersData = null; // 可选：来自 /api/careers 的后端数据

      function detectInitialLanguage(){
        const urlParams = new URLSearchParams(window.location.search);
        const p = urlParams.get('lang');
        // 支持 Next.js 的 locale (zh/en) 和 careers.html 的语言代码 (cn/en)
        if (p === 'en') return 'en';
        if (p === 'zh') return 'cn'; // 将 Next.js 的 'zh' 映射为 'cn'
        if (p === 'cn') return 'cn';
        // 检查 referrer
        if (document.referrer) {
          if (document.referrer.includes('/en')) return 'en';
          if (document.referrer.includes('/zh')) return 'cn';
        }
        return 'cn';
      }

      function setLang(lang){
        console.log('Language switching to:', lang);
        currentLang = lang; 
        localStorage.setItem('lang', lang); 
        // 强制重新渲染所有内容
        render();
        // 如果 API 数据已加载，再次应用以确保内容更新
        if (careersData?.jobs?.length) {
          setTimeout(() => {
            applyJobsFromAPI();
            updateContactFromAPI();
          }, 100);
        }
      }

      // 动态生成tab按钮
      function generateTabs() {
        const tabsContainer = document.getElementById('job-tabs-container');
        if (!tabsContainer) return;
        
        // 清空现有tabs
        tabsContainer.innerHTML = '';
        
        const jobs = careersData?.jobs || [];
        if (jobs.length === 0) return;
        
        jobs.forEach((job, index) => {
          const btn = document.createElement('button');
          btn.className = `tab-btn ${index === 0 ? 'active' : ''}`;
          btn.setAttribute('data-tab', job.id);
          btn.id = `${job.id}-tab`;
          btn.textContent = job.title?.[currentLang] || job.id;
          tabsContainer.appendChild(btn);
        });
        
        // 重新绑定事件（重置tabsBound以便重新绑定）
        tabsBound = false;
      }
      
      // 动态生成职位内容
      function generateJobContents() {
        const contentsContainer = document.getElementById('job-contents-container');
        if (!contentsContainer) return;
        
        // 清空现有内容
        contentsContainer.innerHTML = '';
        
        const jobs = careersData?.jobs || [];
        if (jobs.length === 0) return;
        
        jobs.forEach((job, index) => {
          const contentDiv = document.createElement('div');
          // 只有第一个岗位设置为active，其他默认隐藏
          contentDiv.className = `job-content ${index === 0 ? 'active' : ''}`;
          contentDiv.id = `${job.id}-content`;
          // 确保非active的内容被隐藏
          if (index !== 0) {
            contentDiv.style.display = 'none';
          }
          
          const jobDetails = document.createElement('div');
          jobDetails.className = 'job-details';
          
          // 核心职责
          const responsibilitiesCard = document.createElement('div');
          responsibilitiesCard.className = 'card';
          responsibilitiesCard.innerHTML = `
            <h2><i class="fas fa-tasks"></i> <span id="${job.id}-responsibility-title">${translations[currentLang]['responsibility-title']}</span></h2>
            <ul id="${job.id}-responsibilities"></ul>
          `;
          jobDetails.appendChild(responsibilitiesCard);
          
          // 职位要求
          const requirementsCard = document.createElement('div');
          requirementsCard.className = 'card';
          requirementsCard.innerHTML = `
            <h2><i class="fas fa-user-graduate"></i> <span id="${job.id}-requirements-title">${translations[currentLang]['requirements-title']}</span></h2>
            <ul id="${job.id}-requirements"></ul>
          `;
          jobDetails.appendChild(requirementsCard);
          
          // 优先条件
          const preferredCard = document.createElement('div');
          preferredCard.className = 'card';
          // 获取薪水，优先使用 API 数据，否则使用默认值
          const defaultSalary = currentLang === 'cn' ? '薪资待遇：面议' : 'Salary: Negotiable';
          const salaryText = job.salary?.[currentLang] || defaultSalary;
          preferredCard.innerHTML = `
            <h2><i class="fas fa-star"></i> <span id="${job.id}-preferred-title">${translations[currentLang]['preferred-title']}</span></h2>
            <ul id="${job.id}-preferredConditions"></ul>
            <div class="salary-highlight"><i class="fas fa-money-bill-wave"></i> <span id="${job.id}-salary">${salaryText}</span></div>
          `;
          jobDetails.appendChild(preferredCard);
          
          contentDiv.appendChild(jobDetails);
          contentsContainer.appendChild(contentDiv);
        });
      }
      
      // 渲染流程：先应用内置翻译，再用（可选）接口数据增强
      function render(){
        applyStaticTranslations();
        // 如果API数据存在，动态生成tabs和contents
        if (careersData?.jobs?.length) {
          generateTabs();
          generateJobContents();
          // 生成后立即应用API数据（强制覆盖默认内容）
          applyJobsFromAPI();
        } else {
          // 即使没有API数据，也确保默认内容显示
          generateTabs();
          generateJobContents();
        }
        updateContactFromAPI();
        ensureTabs();
      }

      function applyStaticTranslations(){
        const dict = translations[currentLang];
        Object.keys(dict).forEach((id)=>{
          const el = document.getElementById(id);
          if(!el) return;
          if(el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') el.value = dict[id];
          else el.textContent = dict[id];
        });
      }

      // 辅助函数：解析并渲染内容到指定的ul元素
      // 确保所有内容都作为平级列表项显示，不区分标题和正文
      function renderContentToUl(ulElement, content) {
        if (!ulElement) return false;
        
        // 如果内容为 null、undefined 或空字符串，清空列表（覆盖默认内容）
        if (content === null || content === undefined || content === '') {
          ulElement.innerHTML = '';
          return true; // 返回true表示已更新（即使是清空，也要覆盖默认内容）
        }
        
        // 如果内容只有空白字符，也清空
        if (!content.trim()) {
          ulElement.innerHTML = '';
          return true; // 返回true表示已更新
        }
        
        // 处理HTML内容：移除所有标题格式（strong、h2、h3等），提取纯文本
        if (content.trim().startsWith('<')) {
          try {
            // 创建一个临时容器来解析HTML
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            
            // 提取所有列表项，包括嵌套的列表项
            const allListItems = tempDiv.querySelectorAll('li');
            const items = [];
            
            allListItems.forEach((li) => {
              // 克隆元素以避免修改原始DOM
              const clone = li.cloneNode(true);
              
              // 移除所有标题标签（strong、b、h2、h3等），只保留文本
              const strongEls = clone.querySelectorAll('strong, b, h2, h3, h4, h5, h6');
              strongEls.forEach(el => {
                // 将标题标签替换为纯文本，保留其内容
                const textNode = document.createTextNode(el.textContent || '');
                el.parentNode.replaceChild(textNode, el);
              });
              
              // 移除所有子列表（ul、ol），但保留其内容作为平级项
              const subLists = clone.querySelectorAll('ul, ol');
              subLists.forEach(subList => {
                const subItems = subList.querySelectorAll('li');
                subItems.forEach(subItem => {
                  // 提取子列表项的文本，作为新的平级项
                  const subText = subItem.textContent?.trim() || '';
                  if (subText) {
                    items.push(subText);
                  }
                });
                // 移除子列表
                subList.remove();
              });
              
              // 提取当前列表项的文本（已移除标题和子列表）
              const text = clone.textContent?.trim() || '';
              if (text) {
                items.push(text);
              }
            });
            
            // 如果成功提取了列表项，使用它们
            if (items.length > 0) {
              ulElement.innerHTML = items.map(item => `<li>${item}</li>`).join('');
              return true;
            }
            
            // 如果没有列表项，尝试提取所有文本内容
            const allText = tempDiv.textContent || '';
            if (allText.trim()) {
              const lines = allText.split('\n').filter(line => line.trim());
              if (lines.length > 0) {
                ulElement.innerHTML = lines.map(line => `<li>${line.trim()}</li>`).join('');
                return true;
              }
            }
          } catch (e) {
            console.warn('Error parsing HTML content:', e);
            // 如果解析失败，回退到简单处理
            const textContent = content.replace(/<[^>]*>/g, '').trim();
            if (textContent) {
              const lines = textContent.split('\n').filter(line => line.trim());
              if (lines.length > 0) {
                ulElement.innerHTML = lines.map(line => `<li>${line.trim()}</li>`).join('');
                return true;
              }
            }
          }
        } else {
          // 将纯文本转换为HTML列表格式（每行一个条目，无标题）
          const lines = content.split('\n').filter(line => line.trim());
          if (lines.length > 0) {
            ulElement.innerHTML = lines.map(line => {
              const trimmed = line.trim();
              // 每行转换为一个简单的列表项，无标题和子列表
              return `<li>${trimmed}</li>`;
            }).join('');
            return true; // 返回true表示已更新
          } else {
            // 如果没有有效行，清空列表
            ulElement.innerHTML = '';
            return true;
          }
        }
        
        return false; // 没有更新
      }

      function applyJobsFromAPI(){
        if(!careersData?.jobs?.length) {
          console.log('No careers data from API, using default content');
          return;
        }
        
        console.log('Applying jobs data from API:', careersData.jobs.length, 'jobs', 'currentLang:', currentLang);
        
        careersData.jobs.forEach((job)=>{
          // 更新 tab 按钮标题
          const tabBtn = document.querySelector(`[data-tab="${job.id}"]`);
          if(tabBtn) {
            const title = job.title?.[currentLang];
            if(title) {
              tabBtn.textContent = title;
            } else {
              console.warn(`No title found for job ${job.id} in language ${currentLang}`);
            }
          }
          
          const root = document.getElementById(`${job.id}-content`);
          if(!root) {
            console.warn(`Job content element not found for job: ${job.id}`);
            return;
          }
          
          // 更新标题（核心职责、职位要求、优先条件）
          const respTitleEl = root.querySelector(`#${job.id}-responsibility-title`);
          if(respTitleEl) {
            respTitleEl.textContent = translations[currentLang]['responsibility-title'];
          }
          const reqTitleEl = root.querySelector(`#${job.id}-requirements-title`);
          if(reqTitleEl) {
            reqTitleEl.textContent = translations[currentLang]['requirements-title'];
          }
          const prefTitleEl = root.querySelector(`#${job.id}-preferred-title`);
          if(prefTitleEl) {
            prefTitleEl.textContent = translations[currentLang]['preferred-title'];
          }
          
          // 更新薪资 - 使用精确的 ID 选择器
          const salaryEl = document.getElementById(`${job.id}-salary`);
          if(salaryEl) {
            const salary = job.salary?.[currentLang];
            if(salary) {
              salaryEl.textContent = salary;
              console.log(`Updated salary for job: ${job.id}, lang: ${currentLang}, value: ${salary}`);
            } else {
              // 如果 API 数据中没有薪水，使用默认值
              const defaultSalary = currentLang === 'cn' ? '薪资待遇：面议' : 'Salary: Negotiable';
              salaryEl.textContent = defaultSalary;
              console.warn(`No salary found for job ${job.id} in language ${currentLang}, using default`);
            }
          } else {
            console.warn(`Salary element not found for job: ${job.id}`);
          }
          
          // 更新核心职责 - 强制更新，即使有默认内容或空内容
          const respContent = job.responsibilities?.[currentLang];
          // 明确检查：如果字段存在（包括空字符串），都要更新
          if('responsibilities' in job && job.responsibilities && currentLang in job.responsibilities) {
            const respUl = root.querySelector(`#${job.id}-responsibilities`);
            if(respUl) {
              const updated = renderContentToUl(respUl, respContent || '');
              if(updated) {
                console.log(`Updated responsibilities for job: ${job.id}, lang: ${currentLang}`);
              }
            } else {
              console.warn(`Responsibilities UL not found for job: ${job.id}`);
            }
          }
          
          // 更新职位要求 - 强制更新，即使有默认内容或空内容
          const reqContent = job.requirements?.[currentLang];
          // 明确检查：如果字段存在（包括空字符串），都要更新
          if('requirements' in job && job.requirements && currentLang in job.requirements) {
            const reqUl = root.querySelector(`#${job.id}-requirements`);
            if(reqUl) {
              const updated = renderContentToUl(reqUl, reqContent || '');
              if(updated) {
                console.log(`Updated requirements for job: ${job.id}, lang: ${currentLang}`);
              }
            } else {
              console.warn(`Requirements UL not found for job: ${job.id}`);
            }
          }
          
          // 更新优先条件 - 强制更新，即使有默认内容或空内容
          const preferredConditionsContent = job.preferredConditions?.[currentLang];
          // 明确检查：如果字段存在（包括空字符串），都要更新
          if('preferredConditions' in job && job.preferredConditions && currentLang in job.preferredConditions) {
            const preferredConditionsUl = root.querySelector(`#${job.id}-preferredConditions`);
            if(preferredConditionsUl) {
              const updated = renderContentToUl(preferredConditionsUl, preferredConditionsContent || '');
              if(updated) {
                console.log(`Updated preferred conditions for job: ${job.id}, lang: ${currentLang}`);
              }
            } else {
              console.warn(`Preferred conditions UL not found for job: ${job.id}`);
            }
          }
        });
      }

      function updateContactFromAPI(){
        if(!careersData?.contact) return;
        const phoneEl = document.querySelector('.contact-item i.fa-phone')?.parentElement?.querySelector('span');
        if(phoneEl) phoneEl.textContent = (currentLang==='cn'?'招聘热线: ':'Hotline: ') + careersData.contact.phone;
        const emailEl = document.querySelector('.contact-item i.fa-envelope')?.parentElement?.querySelector('span');
        if(emailEl) emailEl.textContent = (currentLang==='cn'?'邮箱: ':'Email: ') + careersData.contact.email;
        const addrEl = document.getElementById('location-text');
        if(addrEl){ const addr = careersData.contact.address?.[currentLang]; if(addr) addrEl.textContent = addr; }
      }

      let tabsBound = false;
      function ensureTabs(){
        if(tabsBound) return;
        const tabBtns = document.querySelectorAll('.tab-btn');
        const jobContents = document.querySelectorAll('.job-content');
        tabBtns.forEach((btn)=>{
          btn.addEventListener('click', ()=>{
            // 移除所有tab和content的active类
            tabBtns.forEach(b=>b.classList.remove('active'));
            jobContents.forEach(c=>{
              c.classList.remove('active');
              c.style.display = 'none'; // 确保隐藏所有内容
            });
            // 激活当前选中的tab和对应的content
            btn.classList.add('active');
            const targetContent = document.getElementById(`${btn.dataset.tab}-content`);
            if(targetContent) {
              targetContent.classList.add('active');
              targetContent.style.display = 'block'; // 确保显示当前内容
            }
          });
        });
        tabsBound = true;
      }

      async function loadCareersData(){
        try{
          // 添加时间戳防止缓存，确保获取最新数据
          const timestamp = Date.now();
          const res = await fetch(`/api/careers?t=${timestamp}`, { 
            method: 'GET',
            cache: 'no-store',
            headers: {
              'Cache-Control': 'no-cache, no-store, must-revalidate',
              'Pragma': 'no-cache',
              'Expires': '0',
              'Accept': 'application/json'
            }
          });
          if(res.ok){ 
            careersData = await res.json();
            console.log('Careers data loaded successfully from API');
            // 数据加载完成后，强制重新渲染
            render();
          } else {
            console.warn('careers API failed, status:', res.status);
            render(); // 即使失败也渲染，使用默认数据
          }
        }catch(e){ 
          console.warn('careers API failed, using fallback translations only.', e);
          render(); // 即使失败也渲染，使用默认数据
        }
      }

      document.addEventListener('DOMContentLoaded', ()=>{
        document.getElementById('langCN')?.addEventListener('click', ()=>setLang('cn'));
        document.getElementById('langEN')?.addEventListener('click', ()=>setLang('en'));
        document.getElementById('contactBtn')?.addEventListener('click', ()=>{
          alert(currentLang==='cn' ? '感谢您的申请！请将简历发送至: wintexlogistics@wintex.com.ph' : 'Thank you for applying! Please send your resume to: wintexlogistics@wintex.com.ph');
        });
        render();
        loadCareersData();
      });

      // 监听存储事件，当数据更新时重新加载
      window.addEventListener('storage', (e) => {
        if (e.key === 'careers-updated') {
          console.log('Storage event detected, reloading careers data');
          loadCareersData();
        }
      });
      
      // 监听 BroadcastChannel 消息（跨标签页通信）
      try {
        const channel = new BroadcastChannel('careers');
        channel.addEventListener('message', (event) => {
          if (event.data && event.data.type === 'updated') {
            console.log('BroadcastChannel message received, reloading careers data');
            loadCareersData();
          }
        });
      } catch (e) {
        // BroadcastChannel 不支持时忽略
        console.warn('BroadcastChannel not supported');
      }


    //   window.openAdminPage = function(){
    //     const adminUrl = `/${currentLang}/admin/careers`;
    //     window.open(adminUrl, '_blank');
    //   }

      // 直接跳转到编辑页面（权限验证在编辑页面进行）
      window.openAdminPage = function () {
        // 将 'cn' 映射成 Next 路由使用的 'zh'
        const langSegment = (typeof currentLang !== 'undefined' && currentLang === 'en') ? 'en' : 'zh';
        const adminUrl = `/${langSegment}/admin/careers`;
        window.location.href = adminUrl;
      };
    })();
  </script>
</body>
</html>
